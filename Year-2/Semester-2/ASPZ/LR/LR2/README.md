# Лабораторна робота №2
**Тема:** Аналіз ELF-файлів, процесів і пам'яті в Linux

## Мета роботи
Ознайомитись зі структурою ELF-файлів, навчитися аналізувати пам'ять і процеси за допомогою інструментів командного рядка Linux, а також дослідити способи роботи з пам'яттю під час виконання програм.

---

## Компіляція та запуск

### Збірка всіх завдань
```bash
make all
```

### Очистка
```bash
make clean
```

---

## Виконання завдань

### Завдання 2.1: Аналіз time_t та проблема Y2038
Досліджено структуру типу `time_t`, його розмір на 32-бітних та 64-бітних системах. Проаналізовано проблему переповнення Y2038 для 32-бітних систем. Програма виводить інформацію про сегменти ELF-файлу, розміри типів даних та залишок часу до Y2038.

**Ключові концепції:** sizeof, time_t, 32-bit vs 64-bit, ELF сегменти (.text, .data, .bss)

## [Код до завдання](task2.1/time_end.c)

---

### Завдання 2.2: Аналіз сегментів ELF-файлу
Досліджено вплив глобальних, статичних та ініціалізованих змінних на розмір сегментів DATA та BSS. Скрипт `segments.sh` автоматизує аналіз через утиліти `size` та `readelf`.

**Ключові концепції:** .text, .data, .bss сегменти, size, readelf, вплив ініціалізації на розмір файлу

## [Код до завдання](task2.2/fruts.c)
## [Скрипт аналізу](task2.2/segments.sh)

---

### Завдання 2.3: Розташування сегментів пам'яті
Програма демонструє адреси різних сегментів пам'яті: TEXT (код), DATA (ініціалізовані дані), BSS (неініціалізовані дані), HEAP (купа), STACK (стек), CONST (константи). Також показано напрямок росту стеку при рекурсивних викликах.

**Ключові концепції:** адресний простір процесу, malloc, стек vs купа, напрямок росту стеку

## [Код до завдання](task2.3/stack_location.c)

---

### Завдання 2.4: Аналіз стеку з GDB/pstack
Програма створена для аналізу стеку за допомогою відладчика GDB та утиліти pstack. Демонструє ланцюжок викликів функцій та їхнє відображення у стеку.

**Ключові концепції:** GDB, pstack, фрейми стеку, точки зупинки, трасування викликів

## [Код до завдання](task2.4/stacker.c)

---

### Завдання 2.5: Порівняння IP та вершини стеку
Перевірено можливість заміни лічильника команд (IP) вершиною стеку. Програма демонструє, що IP та SP знаходяться в різних адресних просторах та виконують принципово різні функції.

**Висновок:**
- IP вказує на поточну інструкцію, яка виконується. Стек — лише допоміжна структура для збереження адрес повернення при викликах функцій.
- Процесор читає інструкції з пам'яті послідовно за IP. Без IP він не знає, де шукати наступну інструкцію.
- Стек не є основним механізмом керування потоком — він лише зберігає адреси повернення.

## [Код до завдання](task2.5/ip_vs_stack.c)

---

### Варіантне Завдання 15: Вимірювання часу доступу до сегментів пам'яті
Реалізовано програму для вимірювання часу доступу до різних сегментів пам'яті: стеку, купи, глобальних змінних, констант та функцій. Порівнюється послідовний та випадковий доступ для оцінки впливу кешування.

**Ключові концепції:** RDTSC, кеш-лінії, латентність пам'яті, послідовний vs випадковий доступ

## [Код до завдання](variant15/segment_timing.c)

---

## Висновки
Під час виконання лабораторної роботи:
- Здобуто практичні навички аналізу структури ELF-файлів
- Розглянуто сегменти `.text`, `.data`, `.bss` та їхній вміст
- Досліджено роботу стеку, регістрів і пам'яті під час виконання програм
- Вивчено роботу з `gdb`, `readelf`, `size`
- Виявлено принципову важливість лічильника команд (IP) для виконання програм
- Оцінено час доступу до різних сегментів пам'яті
