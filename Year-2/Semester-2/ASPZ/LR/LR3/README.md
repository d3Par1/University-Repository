# Лабораторна робота №3
**Тема:** Дослідження механізмів обмеження ресурсів за допомогою ulimit

## Мета роботи
Дослідити, як операційна система обмежує ресурси процесів: кількість файлових дескрипторів, процесорний час, розмір файлів та стеку. Експерименти проводяться у середовищі Docker-контейнера.

---

## Компіляція та запуск

### Збірка всіх завдань
```bash
make all
```

### Очистка
```bash
make clean
```

---

## Виконання завдань

### Завдання 3.1: Дослідження обмеження кількості відкритих файлів
Запущено Docker-контейнер, в якому проведено експерименти з обмеженням кількості відкритих файлів (`ulimit -n`). Перевірялися поточні значення, змінювалися обмеження та перевірялася їхня допустимість. Аналогічні операції виконувалися від імені root-користувача для порівняння можливостей.

**Висновок:** Обмеження на кількість відкритих файлів можна змінювати, але лише в межах встановлених системних меж (soft і hard ліміти). Root-користувач має розширені можливості щодо зміни цих параметрів.

## [Код до завдання](task3.1/ulimit_demo.sh)

---

### Завдання 3.2: Аналіз продуктивності з обмеженням ресурсів
Реалізовано програму для тестування впливу обмежень файлових дескрипторів та пам'яті на виконання програм. Використовується `setrlimit` для програмного встановлення лімітів та вимірювання продуктивності.

**Висновок:** Ресурсні обмеження ефективно контролюють споживання ресурсів процесом. При досягненні ліміту процес отримує відповідну помилку або сигнал.

## [Код до завдання](task3.2/perf_limit.c)

---

### Завдання 3.3: Кидання кубика з обмеженням розміру файлу
Реалізовано програму, яка імітує кидання шестигранного кубика та записує результати у файл. Перед виконанням встановлено обмеження на максимальний розмір файлу (`RLIMIT_FSIZE`). При досягненні ліміту запис припиняється через сигнал SIGXFSZ.

**Висновок:** Обмеження на розмір файлу працюють належним чином: процес не може записувати більше, ніж дозволено, що потрібно враховувати при розробці програм, що працюють із файлами.

## [Код до завдання](task3.3/dice_sim.c)

---

### Завдання 3.4: Імітація лотереї з обмеженням процесорного часу
Створено програму для генерації випадкових чисел у двох групах (7 з 49 і 6 з 36). Перед запуском встановлюється ліміт на процесорний час (`RLIMIT_CPU`). При перевищенні soft-ліміту процес отримує SIGXCPU, при hard-ліміті — SIGKILL.

**Висновок:** Ліміт процесорного часу дозволяє контролювати тривалість виконання ресурсомістких операцій. Якщо програма не завершується вчасно, ОС її примусово зупиняє.

## [Код до завдання](task3.4/lottery.c)

---

### Завдання 3.5: Копіювання файлів з перевіркою лімітів
Розроблено програму для копіювання файлів з перевіркою наявності аргументів, доступності файлів та обробкою сигналу SIGXFSZ при перевищенні ліміту розміру файлу.

**Висновок:** Обмеження на розмір файлу ефективно перешкоджають створенню файлів, які перевищують допустимий обсяг. Програма коректно обробляє помилки, що важливо для стабільної роботи.

## [Код до завдання](task3.5/filecopy.c)

---

### Завдання 3.6: Демонстрація обмеження розміру стеку
Написано рекурсивну програму, яка викликає сама себе, споживаючи все більше пам'яті стеку. Перед виконанням встановлено обмеження на розмір стеку (`RLIMIT_STACK`). При досягненні ліміту програма завершується з Segmentation fault (SIGSEGV).

**Висновок:** Розмір стеку відіграє ключову роль у роботі рекурсивних функцій. Обмеження може запобігти неконтрольованому росту споживання пам'яті.

## [Код до завдання](task3.6/stack_limit.c)

---

### Варіантне Завдання 15: Дослідження впливу ulimit -f на запис великих файлів
Розроблено програму для дослідження впливу ліміту розміру файлу на різні стратегії запису: fwrite, write() та mmap. Програма порівнює поведінку кожного методу при досягненні ліміту.

**Висновок:** `ulimit -f` ефективно обмежує максимальний розмір файлу для всіх методів запису. Різні системні виклики по-різному реагують на досягнення ліміту, але результат однаковий — запис обмежується.

## [Код до завдання](variant15/ulimit_fsize.c)

---

## Висновок
У ході роботи було проведено експерименти із системними обмеженнями ресурсів у середовищі Docker. Досліджено обмеження на кількість відкритих файлів, час роботи процесів, максимальний розмір файлу та розмір стеку. Розроблені програми коректно обробляють ситуації досягнення лімітів. Отримані результати підтвердили, що `ulimit` та `setrlimit` є ефективними інструментами контролю ресурсів для запобігання перевантаженню системи.
